<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Neural Turing Machine (NTM)">
  <meta name="generator" content="Hugo 0.50" />

  <title>Beyond RNN - Lec1 &middot; Stay hungry. Stay foolish </title>

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://sunprinces.github.io/learning/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://sunprinces.github.io/learning/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://sunprinces.github.io/learning/css/blackburn.css">

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/monokai.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha1/katex.min.css" integrity="sha384-8QOKbPtTFvh/lMY0qPVbXj9hDh+v8US0pD//FcoYFst2lCIf0BmT58+Heqj0IGyx" crossorigin="anonymous">
  
  
  
  <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  
  <link rel="shortcut icon" href="https://sunprinces.github.io/learning/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  <style>
  img{
    padding-left: 15px;
    border-radius: 100%
  }
</style>
<a class="pure-menu-heading brand img-circle" target='_blank' href="https://sunprinces.github.io/">
  <img src="https://sunprinces.github.io/learning/img/logo.png" width="145px" >
</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://sunprinces.github.io/learning/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://sunprinces.github.io/learning/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://sunprinces.github.io/learning/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://sunprinces.github.io/learning/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://sunprinces.github.io/learning/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://instagram.com/sunprince822" target="_blank"><i class="fa fa-instagram fa-fw"></i>Instagram</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/sunprinceS" target="_blank"><i class="fa fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://sunprincelife.wordpress.com/" target="_blank"><i class="fa fa-coffee fa-fw"></i>Life</a>

    </li>
    

  </ul>
</div>


  <div>
  <div class="small-print">
    <span id="busuanzi_container_site_pv">&nbsp;&nbsp;&nbsp;View &nbsp;&nbsp;<b><span id="busuanzi_value_site_pv"></b></span> &nbsp;times</span></span>
  </div>
  <div class="small-print">
    <a href="https://gohugo.io/" target="_blank">Hugo</a>&nbsp;&nbsp;&#9830;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a>
  </div>
  <div class="small-print">
    <small>&nbsp;&nbsp;&copy; 2017. All rights reserved.</small>
  </div>

  <div class="small-print">
  <small>Icons from Flaticon<a href="http://creativecommons.org/licenses/by/3.0/" title="Creative Commons BY 3.0" target="_blank">CC 3.0 BY</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Beyond RNN - Lec1</h1>
  <h2>Neural Turing Machine (NTM)</h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>20 May 2018</time>
  </div>
  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://sunprinces.github.io/learning/topics/beyond-rnn">Beyond RNN</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://sunprinces.github.io/learning/tags/machine-learning">Machine Learning</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://sunprinces.github.io/learning/tags/rnn">RNN</a>
    
  </div>
  
  

</div>


  <p>Beyond RNN é€™å€‹ç³»åˆ—æœƒ focus åœ¨è¿‘å¹´ä¾†å„å¼å„æ¨£æˆ‘è¦ºå¾—æœ‰è¶£çš„ RNN è®Šå½¢ï¼ŒåŠå…¶ç›¸é—œçš„å¯¦åšã€‚</p>

<p>é€™ç¯‡æ–‡ç« çš„ç›¸é—œç¨‹å¼ç¢¼ï¼Œæ”¾åœ¨<a href="https://github.com/sunprinceS/Neural-Turing-Machine">é€™è£¡</a>ã€‚</p>

<p></p>

<p>æœ€è¿‘å‰›å¥½åœ¨å­¸ç¿’ PyTorchï¼Œä¾¿æƒ³æ‰¾å€‹é©åˆçš„é¡Œç›®ä¾†ç·´æ‰‹ï¼Œä½†ä¸€æ˜§åœ° implement æˆ–çœ‹è«–æ–‡éƒ½æœ‰äº›ä¹å‘³ï¼Œå¸Œæœ›è‡ªå·±èƒ½åŒæ™‚éå›ºå¯¦åšèƒ½åŠ›åˆå­¸ç¿’æ–°çš„çŸ¥è­˜ï¼Œä¹Ÿå› æ­¤æœ‰äº†é€™å€‹ç³»åˆ— - Beyond RNNã€‚</p>

<p>æœ‰æ¥è§¸é DL çš„è®€è€…ï¼Œæƒ³å¿…å° RNN (<em>Recurrent Neural Network</em>) ä¸¦ä¸é™Œç”Ÿï¼Œå®ƒä¸»è¦æ‡‰ç”¨åœ¨<strong>è³‡æ–™æœ‰é †åºæ€§</strong>çš„ scenerio (e.g èªéŸ³,æ–‡å­—,è‚¡ç¥¨èµ°å‹¢(?ğŸ˜›)ç­‰ç­‰ &hellip;)ï¼Œé™¤äº† single cell çš„è®Šå½¢å¦‚ LSTM (Long Short Term Memory) å’Œ GRU (Gated Recurrent Unit)ä¹‹å¤–ï¼Œå¦å¤–æœ‰è¨±å¤šå°‡å…¶ equip åœ¨ä¸åŒçš„æ¶æ§‹ä¸Šï¼Œå¼·åŒ–å…¶åŠŸèƒ½çš„å»¶ä¼¸ã€‚</p>

<h2 id="introduction">Introduction</h2>

<p>é€™ä¸€ç¯‡ Post æœƒä»‹ç´¹çš„æ˜¯ <a href="https://arxiv.org/abs/1410.5401">Neural Turing Machine</a> ï¼Œæ˜¯ DeepMind åœ¨ 2014 å¹´
æ‰€ç™¼è¡¨çš„ç ”ç©¶ã€‚</p>

<p>RNN-type çš„ network ï¼Œä¹‹æ‰€ä»¥èƒ½è™•ç† sequence çš„å•é¡Œï¼Œé—œéµåœ¨å®ƒ keep äº† hidden
state (å°æ‡‰åˆ° LSTM çš„ <span>$h,c$</span>&hellip; )ï¼Œå¯ä»¥ç†è§£æˆç•¶ä½œåˆ°ç›®å‰ç‚ºæ­¢ï¼Œç¶œåˆäº†<strong>æ‰€æœ‰ input çš„
representation</strong> ï¼Œè€Œå…¶åˆæœƒéš¨è‘—æ–°çš„ input é€²ä¾†è€Œæœ‰æ‰€æ”¹è®Šã€‚</p>

<h2 id="motivation">Motivation</h2>

<p>ä¸€å€‹å¾ˆè‡ªç„¶çš„å•é¡Œæ˜¯ï¼Œå°æ–¼é‚£äº›å¾ˆé•·çš„ sequence ï¼Œæˆ‘å€‘éœ€è¦é–‹å¤šå¤§çš„ hidden state å»
maintainï¼Ÿ ç›´è¦ºæ‡‰è©²æ˜¯ dimension è¦æ›´å¤§ï¼Œå¯ä»¥æƒ³æˆæˆ‘å€‘è¦ç”¨ä¸€æ¢å¹¾åƒç¶­çš„ vector ä¾†ç•¶ hidden stateã€‚</p>

<p>è€Œå°±åƒ <strong>CNN</strong> çš„ motivation ä¸€æ¨£ï¼Œæˆ‘å€‘å¸Œæœ›æˆ‘å€‘çš„ model èƒ½å¼•é€²å¤šä¸€é»å…ˆå‚™çš„è³‡è¨Šã€‚åœ¨ CNN ä¸­ï¼Œå°æ–¼ structured çš„å½±åƒï¼Œç›´æ¥æŠŠæ¯å€‹ pixel å±•å¹³æˆ 1D vector ä½œç‚º model çš„ inputï¼Œå…¶ performance æ¯”ä¸ä¸Šå°‡å…¶ treat æˆ 2D Tensor ï¼Œè€ƒæ…®é„°è¿‘ pixel çš„ é¡å¤– informationã€‚(å·¥å•†æ™‚é–“: é€™è£¡æœ‰æˆ‘ä¹‹å‰ç•¶ TA æ™‚å‡ºçµ¦åŒå­¸çš„<a href="https://sunprinces.github.io/ML-Assignment3/">ç·´ç¿’</a>ï¼Œåœ¨ FER é€™å€‹ dataset ä¸Šæ¯”è¼ƒ CNN è·Ÿ DNN çš„ performance å„ªåŠ£)</p>

<p>è€Œ NTM çš„ idea ä¹Ÿæ˜¯é¡ä¼¼ï¼Œè—‰ç”±å¼•é€² extra memory ï¼ŒæŠŠåŸå…ˆé‚£å€‹ä¸Šåƒç¶­çš„ 1D hidden vectorï¼ŒæŠ˜æˆ 2D Tensor ä½œç‚º memory ã€‚ä¸¦ä»¿æ•ˆç¾åœ¨é›»è…¦çš„æ¶æ§‹ï¼Œæ§‹é€ å…¶èˆ‡ input interact çš„ mechanismï¼ŒæŠŠ sequence å…ˆå¾Œçš„è³‡è¨Šçµ¦è€ƒæ…®é€²ä¾†ã€‚</p>

<h2 id="basic-structure">Basic Structure</h2>

<p><center><img src="https://sunprinces.github.io/learning/img/post/ntm-structure.png" width="60%" style="border-radius: 0%;"></center></p>

<p>è®€å¯« memory é€™ä»¶äº‹åˆ†æˆå…©å€‹æ­¥é©Ÿï¼Œ<strong>å…§å®¹</strong>åŠ<strong>ä½ç½®</strong>ã€‚<br />
ä»”ç´°æƒ³æƒ³ï¼Œã€Œä½ç½®ã€åœ¨ memory ä¸­ï¼Œæ˜¯<strong>é›¢æ•£</strong>çš„å­˜åœ¨ï¼Œè©²å¦‚ä½•æŠŠå¾å“ªè£¡è®€/å¯«é€™ä»¶äº‹è®Šæˆå¯ä»¥ç”¨ NN å¯ä»¥ train å‘¢ï¼Ÿ<br />
æƒ³æ³•å°±æ˜¯è®“å…¶<strong>å¯å¾®</strong>ï¼Œé€™è£¡çš„ä½œæ³•æ˜¯æ¯æ¬¡åœ¨è®€å¯«æ™‚ï¼Œä¸æ˜¯å° specific ä½ç½®çš„ memory cell åšæ“ä½œï¼Œè€Œ
æ˜¯å°ä¸€å€‹ specific distribution <span>$w$</span> çš„ memory cell å€‘åšæ“ä½œ (ç°¡å–®ä¾†èªªï¼Œå°±æ˜¯åŒæ™‚è€ƒæ…®æ‰€æœ‰
çš„ memory cellï¼Œä½†æ ¹æ“šè£¡é ­å…§å®¹çš„ä¸åŒï¼Œæ±ºå®šå…¶æ‰€ä½”çš„ weight)ã€‚</p>

<h2 id="read-write">Read &amp; Write</h2>

<p>å‡è¨­æ™‚é–“é» <span>$t$</span> ï¼Œæˆ‘å€‘æœ‰äº†ä¸€å€‹ address distribution <span>$w_t$</span>ï¼Œè®€å‡ºä¾†çš„å…§å®¹å¾ˆç°¡å–®å°±æ˜¯</p>

<div>
\[
\mathbf{r}_t \leftarrow \sum_i w_t(i)\mathbf{M}(i)
\]
</div>

<pre><code class="language-python"> def read(self, w):
        &quot;&quot;&quot; Read memory corresponding to the address weighting
        Arguments:
            w: shape = (batch_size,N)
        Outputs:
            shape = (batch_size,M)
        &quot;&quot;&quot;
        return torch.matmul(w.unsqueeze(1), self.memory).squeeze(1)
</code></pre>

<p>å¯«å…¥ memory å°±æ˜¯</p>

<div>
\[
\mathbf{M}_t(i) \leftarrow \tilde \mathbf{M}_t(i)[\mathbf{1} - w_t(i) \mathbf{e}_t] + w_t(i)\mathbf{a}_t
\]
</div>

<pre><code class="language-python">def write(self, w, e, a):
        &quot;&quot;&quot; Erase/Add memory corresponding to the address weighting
        Arguments:
            w: shape = (batch_size,N)
            e,a: shape = (batch_size,M)
        &quot;&quot;&quot;
        self.prev_mem = self.memory
        erase = torch.matmul(w.unsqueeze(-1), e.unsqueeze(1))
        add = torch.matmul(w.unsqueeze(-1), a.unsqueeze(1))
        self.memory = self.prev_mem * (1 - erase) + add
</code></pre>

<h2 id="address-mechanism">Address Mechanism</h2>

<p>æˆ‘è¦ºå¾—é€™éƒ¨ä»½å°±æ˜¯ NTM ä¸­æœ€ç²¾è¯çš„ä¸€æ®µäº†ï¼Œè¨è«–äº†å¦‚ä½•å¾—åˆ° address distribution
<span>$w_t$</span>ï¼Œæ‰€ç”¨åˆ°çš„æ¦‚å¿µï¼Œä¹Ÿæ˜¯ä¹‹å¾Œ attention-based model çš„ motivationã€‚</p>

<h3 id="content-based-attention">Content-based Attention</h3>

<p>æ ¹æ“š memory cell ç¾åœ¨æ‰€ç´€éŒ„çš„å…§å®¹èˆ‡ controller çš„ output key vector <span>$\mathbf{k}$</span> (äº¦å³ <span>$f$</span>(input))åšæ¯”è¼ƒï¼Œæ±ºå®šè©² memory cell æ‰€è¦ä½”çš„æ¯”é‡ (è¶Šé¡ä¼¼è€…ï¼Œæ¬Šé‡è¶Šé«˜)ã€‚</p>

<div>
\[
w_c(i) \leftarrow \frac{e^{\beta K[\textbf{k},\textbf{M}(i)] } }{ \sum_{j} e^{ \beta K[\textbf{k},\textbf{M}(j)] } }
\]
</div>

<p><strong>Note:</strong> <span>$K[u,v]$</span>æ˜¯ similarity çš„ measureï¼Œä¸€èˆ¬ç”¨ cosine
similarity</p>

<h3 id="location-based-attention">Location-based Attention</h3>

<p>As titleï¼Œæˆ‘å€‘å¾ä¸Šä¸€æ­¥ä¸­ï¼Œå¾—åˆ°äº† <span>$w_c$</span>ï¼Œä½†æ ¹æ“šä¸åŒçš„ input ï¼Œåˆå†å¤šè€ƒæ…®é€™äº› moemory cell èˆ‡å…¶é„°è¿‘è€…çš„ distribution ã€‚</p>

<h4 id="interpolation">Interpolation</h4>

<p>è€ƒæ…®ä¸Šä¸€å€‹æ™‚é–“é» address weighting çš„å½±éŸ¿</p>

<div>
\[
\textbf{w}_{t} \leftarrow g \textbf{w}_{t} + (1-g) \textbf{w}_{t-1}
\]
</div>

<h4 id="convolution-shift">Convolution Shift</h4>

<p>å°‡æŸä¸€ä½ç½®çš„ memory cell ä¹‹ weighting ä¸Šï¼Œå†è€ƒæ…®å…¶èˆ‡é„°è¿‘ memory cell çš„
distribution (åœ¨æ­¤æˆ‘å€‘è€ƒæ…®å·¦å³å„ä¸€å€‹ memoryï¼Œå¦‚æœ weight æ˜¯ <span>$(0,0,1)$</span> çš„è©±ï¼Œæ„æ€
å°±æ˜¯åŸå…ˆè©² cell å¾—åˆ°çš„æ‰€æœ‰ weight éƒ½ apply çµ¦å…¶å³é‚Šçš„ cell)</p>

<div>
\[
w(i) \leftarrow w(i+1) s(-1) + w(i)s(0) + w(i-1)s(1)
\]
</div>

<h4 id="reweighting-sharpening">Reweighting - Sharpening</h4>

<div>
\[
w(i) \leftarrow \frac{w(i)^{\gamma}}{\sum_{j}w(j)^{\gamma}}
\]
</div>

<p>ç¶œåˆèµ·ä¾†ï¼Œæ•´å€‹ mechanism æ˜¯é€™æ¨£é‹ä½œçš„ã€‚
<center><img src="https://sunprinces.github.io/learning/img/post/ntm-address-mechanism.png" width="80%" style="border-radius: 0%;"></center></p>

<pre><code class="language-python">def address(self, k, beta, g, s, gamma, w_prev):
       # Content focus
       wc = self._similarity(k, beta)

       # Location focus
       wg = self._interpolate(w_prev, wc, g)
       w_hat = self._shift(wg, s)
       w = self._sharpen(w_hat, gamma)

       return w

   def _similarity(self, k, beta):
       cos_sim = F.cosine_similarity(self.memory + 1e-16, k.unsqueeze(1) + 1e-16, dim=-1)
       w = F.softmax(beta * cos_sim , dim=1)
       return w

   def _interpolate(self, w_prev, wc, g):
       return g * wc + (1 - g) * w_prev

   def _shift(self, wg, s):
       #consider 3 locations together
       conved = torch.cat([wg[:,-1:],wg,wg[:,:1]],dim=1) #pad in the beginning and end
       result = F.conv1d(conved.unsqueeze(1),s.unsqueeze(1))
       return torch.cat([result[i:i+1,i,:] for i in range(self.batch_size)])

   def _sharpen(self, w_hat, gamma):
       w = w_hat ** gamma
       w = torch.div(w, torch.sum(w, dim=1).view(-1, 1) + 1e-16)
       return w
</code></pre>

<h2 id="experiment-discussion">Experiment &amp; Discussion</h2>

<p>ç›¸é—œå¯¦é©—å¯ä»¥åœ¨ <a href="https://github.com/sunprinceS/Neural-Turing-Machine/blob/master/NTM-Copy-Analysis.ipynb">ipython notebook</a> æ‰¾åˆ°</p>

<h3 id="copy-task">Copy Task</h3>

<p>é€™æ˜¯æˆ‘éš¨æ©Ÿç”¨é•·åº¦ç‚º 3 ~ 20 çš„ sequence è¨“ç·´çš„çµæœï¼Œä¸¦æ‹¿é•·åº¦ç‚º 30 çš„ sequence ç•¶ä½œ
validation dataã€‚
<center><img src="https://sunprinces.github.io/learning/img/post/ntm-copy-cost-0320.png" width="80%" style="border-radius: 0%;"></center>
å…¶å¯¦åˆ° 20k ä»¥å¾Œï¼Œå°±å¯ä»¥ fit training data äº†ï¼Œä½†å°æ–¼æ›´é•·çš„ sequence ä¹‹ generalization ï¼Œå¶çˆ¾æœƒæœ‰çˆ›æ‰çš„å¯èƒ½ã€‚</p>

<p>å¾ output çš„ posterior ä¾†çœ‹ï¼Œä¹Ÿå¯ä»¥çœ‹å‡º model å…¶å¯¦è »è‚¯å®šçš„</p>

<p><center><img src="https://sunprinces.github.io/learning/img/post/ntm-copy-pred-0320.png" width="80%" style="border-radius: 0%;"></center></p>

<p>ä¸€å€‹æœ‰è¶£çš„å•é¡Œæ˜¯ï¼Œå¦‚æœç”¨æ›´çŸ­çš„ sequence åš training å‘¢ï¼Ÿ<br />
æ¯”æ–¹èªª 3 ~ 10 çš„ sequence ï¼Œå…¶é‚„èƒ½å¤ é¡æ¨åˆ°é•·åº¦ç‚º 30 çš„ sequence å—ï¼Ÿ</p>

<p><center><img src="https://sunprinces.github.io/learning/img/post/ntm-copy-cost-0310.png" width="80%" style="border-radius: 0%;"></center>
<center><img src="https://sunprinces.github.io/learning/img/post/ntm-copy-pred-0310-L20.png" width="80%" style="border-radius: 0%;"></center>
<center><img src="https://sunprinces.github.io/learning/img/post/ntm-copy-pred-0310-L30.png" width="80%" style="border-radius: 0%;"></center></p>

<p>å¯¦é©—çµæœçœ‹èµ·ä¾†æ˜¯ä¸è¡ŒğŸ˜…ã€‚<br />
è€Œä¸”é•·åº¦ 20 çš„ sequence ä¹Ÿå­¸ä¸èµ·ä¾†ï¼Œé€™æ¨£æ˜¯å¦ä»£è¡¨ NTM æ²’æœ‰ generalization çš„èƒ½åŠ›å‘¢ï¼Ÿ</p>

<p>è®“æˆ‘å€‘æŠŠ train åœ¨ é•·åº¦ç‚º 3 ~ 20 çš„ sequence ä¹‹ modelï¼Œæ‹¿ä¾† predict åœ¨é•·åº¦ <span>$\geq 20$</span>çš„ sequence ä¸Šã€‚</p>

<p><center><img src="https://sunprinces.github.io/learning/img/post/ntm-copy-error-curve.png" width="60%" style="border-radius: 0%;"></center></p>

<p>çœ‹èµ·ä¾†å®ƒæ˜¯æœ‰å­¸åˆ° generalization çš„ï¼Œ<br />
è€Œä¸”å°æ–¼ memory å·²ç¶“ä¸å¤ æ”¾çš„éƒ¨ä»½ï¼Œä¹Ÿä¸æ˜¯ä¸€å£æ°£çˆ›æ‰ï¼Œé‚„æ˜¯æœ‰ç›¡é‡è¨˜åˆ°ä¸€äº›å€¼ã€‚</p>

<p><strong>Remark:</strong> model generalization çš„èƒ½åŠ›èˆ‡å…¶çœ‹éçš„ training data æœ‰é—œï¼Œä½†ä¸æ˜¯ç°¡å–®çš„ç·šæ€§é—œä¿‚è€Œå·²ã€‚</p>

<h3 id="some-training-detail">Some Training Detail</h3>

<ul>
<li>Memory çš„ä½¿ç”¨åŠ R/W weight è®ŠåŒ–</li>
</ul>

<p><center><img src="https://sunprinces.github.io/learning/img/post/ntm-memory-use.png" width="100%" style="border-radius: 0%;"></center></p>

<p><center><img src="https://sunprinces.github.io/learning/img/post/ntm-head-weight.png" width="100%" style="border-radius: 0%;"></center></p>

<ul>
<li>é€™è£¡å¯¦åšçš„ NTM ï¼Œcontoller åœ¨è¼¸å‡º final output æ™‚ï¼ŒåŒæ™‚è€ƒæ…®äº† read head ä»¥åŠ input çš„å€¼ã€‚<br />
åœ¨ prediction éšæ®µï¼Œ current input éƒ½æ˜¯ dummy çš„ <span>$\mathbf{0}$</span> vectorï¼Œä½†å¦‚æœä¸è€ƒæ…®å®ƒçš„è©±ï¼ŒNTM å°±ç„¡æ³• train èµ·ä¾†ï¼Œæ¨æ¸¬å¯èƒ½æ˜¯åœ¨é‚£å€‹ dummy vector ï¼Œå° model è€Œè¨€å°±æ˜¯åƒ…æœ‰è®€è€Œæ²’æœ‰å¯«çš„æŒ‡ä»¤(å¦‚åŒä¸Šæ–¹æ‰€æåˆ°çš„ R/W mode åˆ‡æ›)ã€‚</li>
</ul>

<pre><code class="language-python">def forward(self,x):
       &quot;&quot;&quot;NTM forward&quot;&quot;&quot;
       prev_reads,prev_ctrl_state,prev_heads_state = self.prev_state
       inp = torch.cat([x] + prev_reads,dim=1)
       ctrl_outp,ctrl_state = self.controller(inp,prev_ctrl_state)
       reads = []
       heads_state = []
       for head,prev_head_state in zip(self.heads,prev_heads_state):
           if head.is_read_head():
               r,head_state = head(ctrl_outp,prev_head_state)
               reads += [r]
           else:
               head_state = head(ctrl_outp,prev_head_state)
           heads_state += [head_state]

       # Retrieve output according to current reads
       inp2 = torch.cat([x] + reads, dim=1)
       o = F.sigmoid(self.fc(inp2)) # range: [0,1]
       self.prev_state = (reads,ctrl_state,heads_state)

       return o, self.prev_state
</code></pre>

<h2 id="reference">Reference</h2>

<ul>
<li><a href="https://distill.pub/2016/augmented-rnns/">Distill ä¸Šçš„æ–‡ç« </a></li>
<li><a href="https://arxiv.org/abs/1410.5401">åŸå§‹è«–æ–‡</a></li>
</ul>
  
  <div align="right"><i class="fa fa-users fa-fw"></i>&nbsp;<span id="busuanzi_container_page_pv">View &nbsp;<b><span id="busuanzi_value_page_pv"></span></b> &nbsp;times</span></div>

  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://sunprinces.github.io/learning/2018/04/speech-recognition-lec6/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://sunprinces.github.io/learning/2018/04/speech-recognition-lec6/">Speech Recognition- Lec6</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://sunprinces.github.io/learning/2018/10/ntu-machine-learning-lec13/">NTU Machine Learning - Lec13</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://sunprinces.github.io/learning/2018/10/ntu-machine-learning-lec13/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>



  
<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'tonyhsu822';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha1/katex.min.js" integrity="sha384-GR8SEkOO1rBN/jnOcQDFcFmwXAevSLx7/Io9Ps1rkxWp983ZIuUGfxivlF/5f5eJ" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha1/contrib/auto-render.min.js" integrity="sha384-cXpztMJlr2xFXyDSIfRWYSMVCXZ9HeGXvzyKTYrn03rsMAlOtIQVzjty5ULbaP8L" crossorigin="anonymous"></script>
 <script>renderMathInElement(document.body, {
   delimiters: [
     {left: "\\[", right: "\\]", display: true},
     {left: "$", right: "$", display: false},
   ]
 });</script>


<script type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [],
    displayMath: [['$$','$$']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});
</script>




</div>

</div>
</div>
<script src="https://sunprinces.github.io/learning/js/ui.js"></script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59748795-3', 'auto');
  ga('send', 'pageview');

</script>





</body>
</html>

