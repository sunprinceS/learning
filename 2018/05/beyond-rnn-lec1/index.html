<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Neural Turing Machine (NTM)">
  <meta name="generator" content="Hugo 0.62.0" />

  <title>Beyond RNN - Lec1 &middot; Stay hungry. Stay foolish </title>

    

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://sunprinces.github.io/learning/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://sunprinces.github.io/learning/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://sunprinces.github.io/learning/css/blackburn.css">

  
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.9.0/css/all.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/monokai.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
  

  <link rel="shortcut icon" href="https://sunprinces.github.io/learning/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  <style>
  img{
    padding-left: 15px;
    border-radius: 100%
  }
</style>
<a class="pure-menu-heading brand img-circle" target='_blank' href="https://sunprinces.github.io/">
  <img src="https://sunprinces.github.io/learning/img/logo.png" width="145px" >
</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://sunprinces.github.io/learning/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://sunprinces.github.io/learning/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://sunprinces.github.io/learning/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://sunprinces.github.io/learning/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://sunprinces.github.io/learning/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/sunprinceS_0822" rel="me" target="_blank"><i class="fab fa-twitter-square fa-fw"></i>Twitter</a>
    </li>
    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://instagram.com/sunprince822" rel="me" target="_blank"><i class="fab fa-instagram fa-fw"></i>Instagram</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/sunprinceS" rel="me" target="_blank"><i class="fab fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://sunprincelife.wordpress.com/" target="_blank"><i class="fa fa-coffee fa-fw"></i>Life</a>
    </li>
    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Beyond RNN - Lec1</h1>
  <h2>Neural Turing Machine (NTM)</h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>20 May 2018</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://sunprinces.github.io/learning/topics/beyond-rnn">Beyond RNN</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://sunprinces.github.io/learning/tags/machine-learning">Machine Learning</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://sunprinces.github.io/learning/tags/rnn">RNN</a>
    
  </div>
  
  

</div>

  <p>Beyond RNN é€™å€‹ç³»åˆ—æœƒ focus åœ¨è¿‘å¹´ä¾†å„å¼å„æ¨£æˆ‘è¦ºå¾—æœ‰è¶£çš„ RNN è®Šå½¢ï¼ŒåŠå…¶ç›¸é—œçš„å¯¦åšã€‚</p>
<p>é€™ç¯‡æ–‡ç« çš„ç›¸é—œç¨‹å¼ç¢¼ï¼Œæ”¾åœ¨<a href="https://github.com/sunprinceS/Neural-Turing-Machine">é€™è£¡</a>ã€‚</p>
<p>æœ€è¿‘å‰›å¥½åœ¨å­¸ç¿’ PyTorchï¼Œä¾¿æƒ³æ‰¾å€‹é©åˆçš„é¡Œç›®ä¾†ç·´æ‰‹ï¼Œä½†ä¸€æ˜§åœ° implement æˆ–çœ‹è«–æ–‡éƒ½æœ‰äº›ä¹å‘³ï¼Œå¸Œæœ›è‡ªå·±èƒ½åŒæ™‚éå›ºå¯¦åšèƒ½åŠ›åˆå­¸ç¿’æ–°çš„çŸ¥è­˜ï¼Œä¹Ÿå› æ­¤æœ‰äº†é€™å€‹ç³»åˆ— - Beyond RNNã€‚</p>
<p>æœ‰æ¥è§¸é DL çš„è®€è€…ï¼Œæƒ³å¿…å° RNN (<em>Recurrent Neural Network</em>) ä¸¦ä¸é™Œç”Ÿï¼Œå®ƒä¸»è¦æ‡‰ç”¨åœ¨<strong>è³‡æ–™æœ‰é †åºæ€§</strong>çš„ scenerio (e.g èªéŸ³,æ–‡å­—,è‚¡ç¥¨èµ°å‹¢(?ğŸ˜›)ç­‰ç­‰ &hellip;)ï¼Œé™¤äº† single cell çš„è®Šå½¢å¦‚ LSTM (Long Short Term Memory) å’Œ GRU (Gated Recurrent Unit)ä¹‹å¤–ï¼Œå¦å¤–æœ‰è¨±å¤šå°‡å…¶ equip åœ¨ä¸åŒçš„æ¶æ§‹ä¸Šï¼Œå¼·åŒ–å…¶åŠŸèƒ½çš„å»¶ä¼¸ã€‚</p>
<h2 id="introduction">Introduction</h2>
<p>é€™ä¸€ç¯‡ Post æœƒä»‹ç´¹çš„æ˜¯ <a href="https://arxiv.org/abs/1410.5401">Neural Turing Machine</a> ï¼Œæ˜¯ DeepMind åœ¨ 2014 å¹´
æ‰€ç™¼è¡¨çš„ç ”ç©¶ã€‚</p>
<p>RNN-type çš„ network ï¼Œä¹‹æ‰€ä»¥èƒ½è™•ç† sequence çš„å•é¡Œï¼Œé—œéµåœ¨å®ƒ keep äº† hidden
state (å°æ‡‰åˆ° LSTM çš„ <!-- raw HTML omitted -->$h,c$<!-- raw HTML omitted -->&hellip; )ï¼Œå¯ä»¥ç†è§£æˆç•¶ä½œåˆ°ç›®å‰ç‚ºæ­¢ï¼Œç¶œåˆäº†<strong>æ‰€æœ‰ input çš„
representation</strong> ï¼Œè€Œå…¶åˆæœƒéš¨è‘—æ–°çš„ input é€²ä¾†è€Œæœ‰æ‰€æ”¹è®Šã€‚</p>
<h2 id="motivation">Motivation</h2>
<p>ä¸€å€‹å¾ˆè‡ªç„¶çš„å•é¡Œæ˜¯ï¼Œå°æ–¼é‚£äº›å¾ˆé•·çš„ sequence ï¼Œæˆ‘å€‘éœ€è¦é–‹å¤šå¤§çš„ hidden state å»
maintainï¼Ÿ ç›´è¦ºæ‡‰è©²æ˜¯ dimension è¦æ›´å¤§ï¼Œå¯ä»¥æƒ³æˆæˆ‘å€‘è¦ç”¨ä¸€æ¢å¹¾åƒç¶­çš„ vector ä¾†ç•¶ hidden stateã€‚</p>
<p>è€Œå°±åƒ <strong>CNN</strong> çš„ motivation ä¸€æ¨£ï¼Œæˆ‘å€‘å¸Œæœ›æˆ‘å€‘çš„ model èƒ½å¼•é€²å¤šä¸€é»å…ˆå‚™çš„è³‡è¨Šã€‚åœ¨ CNN ä¸­ï¼Œå°æ–¼ structured çš„å½±åƒï¼Œç›´æ¥æŠŠæ¯å€‹ pixel å±•å¹³æˆ 1D vector ä½œç‚º model çš„ inputï¼Œå…¶ performance æ¯”ä¸ä¸Šå°‡å…¶ treat æˆ 2D Tensor ï¼Œè€ƒæ…®é„°è¿‘ pixel çš„ é¡å¤– informationã€‚(å·¥å•†æ™‚é–“: é€™è£¡æœ‰æˆ‘ä¹‹å‰ç•¶ TA æ™‚å‡ºçµ¦åŒå­¸çš„<a href="https://sunprinces.github.io/ML-Assignment3/">ç·´ç¿’</a>ï¼Œåœ¨ FER é€™å€‹ dataset ä¸Šæ¯”è¼ƒ CNN è·Ÿ DNN çš„ performance å„ªåŠ£)</p>
<p>è€Œ NTM çš„ idea ä¹Ÿæ˜¯é¡ä¼¼ï¼Œè—‰ç”±å¼•é€² extra memory ï¼ŒæŠŠåŸå…ˆé‚£å€‹ä¸Šåƒç¶­çš„ 1D hidden vectorï¼ŒæŠ˜æˆ 2D Tensor ä½œç‚º memory ã€‚ä¸¦ä»¿æ•ˆç¾åœ¨é›»è…¦çš„æ¶æ§‹ï¼Œæ§‹é€ å…¶èˆ‡ input interact çš„ mechanismï¼ŒæŠŠ sequence å…ˆå¾Œçš„è³‡è¨Šçµ¦è€ƒæ…®é€²ä¾†ã€‚</p>
<h2 id="basic-structure">Basic Structure</h2>
<!-- raw HTML omitted -->
<p>è®€å¯« memory é€™ä»¶äº‹åˆ†æˆå…©å€‹æ­¥é©Ÿï¼Œ<strong>å…§å®¹</strong>åŠ<strong>ä½ç½®</strong>ã€‚\<br>
ä»”ç´°æƒ³æƒ³ï¼Œã€Œä½ç½®ã€åœ¨ memory ä¸­ï¼Œæ˜¯<strong>é›¢æ•£</strong>çš„å­˜åœ¨ï¼Œè©²å¦‚ä½•æŠŠå¾å“ªè£¡è®€/å¯«é€™ä»¶äº‹è®Šæˆå¯ä»¥ç”¨ NN å¯ä»¥ train å‘¢ï¼Ÿ\<br>
æƒ³æ³•å°±æ˜¯è®“å…¶<strong>å¯å¾®</strong>ï¼Œé€™è£¡çš„ä½œæ³•æ˜¯æ¯æ¬¡åœ¨è®€å¯«æ™‚ï¼Œä¸æ˜¯å° specific ä½ç½®çš„ memory cell åšæ“ä½œï¼Œè€Œ
æ˜¯å°ä¸€å€‹ specific distribution <!-- raw HTML omitted -->$w$<!-- raw HTML omitted --> çš„ memory cell å€‘åšæ“ä½œ (ç°¡å–®ä¾†èªªï¼Œå°±æ˜¯åŒæ™‚è€ƒæ…®æ‰€æœ‰
çš„ memory cellï¼Œä½†æ ¹æ“šè£¡é ­å…§å®¹çš„ä¸åŒï¼Œæ±ºå®šå…¶æ‰€ä½”çš„ weight)ã€‚</p>
<h2 id="read--write">Read &amp; Write</h2>
<p>å‡è¨­æ™‚é–“é» <!-- raw HTML omitted -->$t$<!-- raw HTML omitted --> ï¼Œæˆ‘å€‘æœ‰äº†ä¸€å€‹ address distribution <!-- raw HTML omitted -->$w_t$<!-- raw HTML omitted -->ï¼Œè®€å‡ºä¾†çš„å…§å®¹å¾ˆç°¡å–®å°±æ˜¯</p>
<!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"> <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">read</span>(self, w):
        <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;&#34;&#34;</span><span style="color:#e6db74"> Read memory corresponding to the address weighting</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">        Arguments:</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">            w: shape = (batch_size,N)</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">        Outputs:</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">            shape = (batch_size,M)</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">        </span><span style="color:#e6db74">&#34;&#34;&#34;</span>
        <span style="color:#66d9ef">return</span> torch<span style="color:#f92672">.</span>matmul(w<span style="color:#f92672">.</span>unsqueeze(<span style="color:#ae81ff">1</span>), self<span style="color:#f92672">.</span>memory)<span style="color:#f92672">.</span>squeeze(<span style="color:#ae81ff">1</span>)
</code></pre></div><p>å¯«å…¥ memory å°±æ˜¯</p>
<!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">write</span>(self, w, e, a):
        <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;&#34;&#34;</span><span style="color:#e6db74"> Erase/Add memory corresponding to the address weighting</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">        Arguments:</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">            w: shape = (batch_size,N)</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">            e,a: shape = (batch_size,M)</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">        </span><span style="color:#e6db74">&#34;&#34;&#34;</span>
        self<span style="color:#f92672">.</span>prev_mem <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>memory
        erase <span style="color:#f92672">=</span> torch<span style="color:#f92672">.</span>matmul(w<span style="color:#f92672">.</span>unsqueeze(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>), e<span style="color:#f92672">.</span>unsqueeze(<span style="color:#ae81ff">1</span>))
        add <span style="color:#f92672">=</span> torch<span style="color:#f92672">.</span>matmul(w<span style="color:#f92672">.</span>unsqueeze(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>), a<span style="color:#f92672">.</span>unsqueeze(<span style="color:#ae81ff">1</span>))
        self<span style="color:#f92672">.</span>memory <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>prev_mem <span style="color:#f92672">*</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span> erase) <span style="color:#f92672">+</span> add
</code></pre></div><h2 id="address-mechanism">Address Mechanism</h2>
<p>æˆ‘è¦ºå¾—é€™éƒ¨ä»½å°±æ˜¯ NTM ä¸­æœ€ç²¾è¯çš„ä¸€æ®µäº†ï¼Œè¨è«–äº†å¦‚ä½•å¾—åˆ° address distribution
<!-- raw HTML omitted -->$w_t$<!-- raw HTML omitted -->ï¼Œæ‰€ç”¨åˆ°çš„æ¦‚å¿µï¼Œä¹Ÿæ˜¯ä¹‹å¾Œ attention-based model çš„ motivationã€‚</p>
<h3 id="content-based-attention">Content-based Attention</h3>
<p>æ ¹æ“š memory cell ç¾åœ¨æ‰€ç´€éŒ„çš„å…§å®¹èˆ‡ controller çš„ output key vector <!-- raw HTML omitted -->$\mathbf{k}$<!-- raw HTML omitted --> (äº¦å³ <!-- raw HTML omitted -->$f$<!-- raw HTML omitted -->(input))åšæ¯”è¼ƒï¼Œæ±ºå®šè©² memory cell æ‰€è¦ä½”çš„æ¯”é‡ (è¶Šé¡ä¼¼è€…ï¼Œæ¬Šé‡è¶Šé«˜)ã€‚</p>
<!-- raw HTML omitted -->
<p><strong>Note:</strong> <!-- raw HTML omitted -->$K[u,v]$<!-- raw HTML omitted -->æ˜¯ similarity çš„ measureï¼Œä¸€èˆ¬ç”¨ cosine
similarity</p>
<h3 id="location-based-attention">Location-based Attention</h3>
<p>As titleï¼Œæˆ‘å€‘å¾ä¸Šä¸€æ­¥ä¸­ï¼Œå¾—åˆ°äº† <!-- raw HTML omitted -->$w_c$<!-- raw HTML omitted -->ï¼Œä½†æ ¹æ“šä¸åŒçš„ input ï¼Œåˆå†å¤šè€ƒæ…®é€™äº› moemory cell èˆ‡å…¶é„°è¿‘è€…çš„ distribution ã€‚</p>
<h4 id="interpolation">Interpolation</h4>
<p>è€ƒæ…®ä¸Šä¸€å€‹æ™‚é–“é» address weighting çš„å½±éŸ¿</p>
<!-- raw HTML omitted -->
<h4 id="convolution-shift">Convolution Shift</h4>
<p>å°‡æŸä¸€ä½ç½®çš„ memory cell ä¹‹ weighting ä¸Šï¼Œå†è€ƒæ…®å…¶èˆ‡é„°è¿‘ memory cell çš„
distribution (åœ¨æ­¤æˆ‘å€‘è€ƒæ…®å·¦å³å„ä¸€å€‹ memoryï¼Œå¦‚æœ weight æ˜¯ <!-- raw HTML omitted -->$(0,0,1)$<!-- raw HTML omitted --> çš„è©±ï¼Œæ„æ€
å°±æ˜¯åŸå…ˆè©² cell å¾—åˆ°çš„æ‰€æœ‰ weight éƒ½ apply çµ¦å…¶å³é‚Šçš„ cell)</p>
<!-- raw HTML omitted -->
<h4 id="reweighting---sharpening">Reweighting - Sharpening</h4>
<!-- raw HTML omitted -->
<p>ç¶œåˆèµ·ä¾†ï¼Œæ•´å€‹ mechanism æ˜¯é€™æ¨£é‹ä½œçš„ã€‚</p>
<!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">address</span>(self, k, beta, g, s, gamma, w_prev):
       <span style="color:#75715e"># Content focus</span>
       wc <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_similarity(k, beta)

       <span style="color:#75715e"># Location focus</span>
       wg <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_interpolate(w_prev, wc, g)
       w_hat <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_shift(wg, s)
       w <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_sharpen(w_hat, gamma)

       <span style="color:#66d9ef">return</span> w

   <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_similarity</span>(self, k, beta):
       cos_sim <span style="color:#f92672">=</span> F<span style="color:#f92672">.</span>cosine_similarity(self<span style="color:#f92672">.</span>memory <span style="color:#f92672">+</span> <span style="color:#ae81ff">1e-16</span>, k<span style="color:#f92672">.</span>unsqueeze(<span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> <span style="color:#ae81ff">1e-16</span>, dim<span style="color:#f92672">=</span><span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
       w <span style="color:#f92672">=</span> F<span style="color:#f92672">.</span>softmax(beta <span style="color:#f92672">*</span> cos_sim , dim<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
       <span style="color:#66d9ef">return</span> w

   <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_interpolate</span>(self, w_prev, wc, g):
       <span style="color:#66d9ef">return</span> g <span style="color:#f92672">*</span> wc <span style="color:#f92672">+</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span> g) <span style="color:#f92672">*</span> w_prev

   <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_shift</span>(self, wg, s):
       <span style="color:#75715e">#consider 3 locations together</span>
       conved <span style="color:#f92672">=</span> torch<span style="color:#f92672">.</span>cat([wg[:,<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>:],wg,wg[:,:<span style="color:#ae81ff">1</span>]],dim<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>) <span style="color:#75715e">#pad in the beginning and end</span>
       result <span style="color:#f92672">=</span> F<span style="color:#f92672">.</span>conv1d(conved<span style="color:#f92672">.</span>unsqueeze(<span style="color:#ae81ff">1</span>),s<span style="color:#f92672">.</span>unsqueeze(<span style="color:#ae81ff">1</span>))
       <span style="color:#66d9ef">return</span> torch<span style="color:#f92672">.</span>cat([result[i:i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>,i,:] <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(self<span style="color:#f92672">.</span>batch_size)])

   <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_sharpen</span>(self, w_hat, gamma):
       w <span style="color:#f92672">=</span> w_hat <span style="color:#f92672">*</span><span style="color:#f92672">*</span> gamma
       w <span style="color:#f92672">=</span> torch<span style="color:#f92672">.</span>div(w, torch<span style="color:#f92672">.</span>sum(w, dim<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>view(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> <span style="color:#ae81ff">1e-16</span>)
       <span style="color:#66d9ef">return</span> w
</code></pre></div><h2 id="experiment--discussion">Experiment &amp; Discussion</h2>
<p>ç›¸é—œå¯¦é©—å¯ä»¥åœ¨ <a href="https://github.com/sunprinceS/Neural-Turing-Machine/blob/master/NTM-Copy-Analysis.ipynb">ipython notebook</a> æ‰¾åˆ°</p>
<h3 id="copy-task">Copy Task</h3>
<p>é€™æ˜¯æˆ‘éš¨æ©Ÿç”¨é•·åº¦ç‚º 3 ~ 20 çš„ sequence è¨“ç·´çš„çµæœï¼Œä¸¦æ‹¿é•·åº¦ç‚º 30 çš„ sequence ç•¶ä½œ
validation dataã€‚</p>
<!-- raw HTML omitted -->
<p>å¾ output çš„ posterior ä¾†çœ‹ï¼Œä¹Ÿå¯ä»¥çœ‹å‡º model å…¶å¯¦è »è‚¯å®šçš„</p>
<!-- raw HTML omitted -->
<p>ä¸€å€‹æœ‰è¶£çš„å•é¡Œæ˜¯ï¼Œå¦‚æœç”¨æ›´çŸ­çš„ sequence åš training å‘¢ï¼Ÿ\<br>
æ¯”æ–¹èªª 3 ~ 10 çš„ sequence ï¼Œå…¶é‚„èƒ½å¤ é¡æ¨åˆ°é•·åº¦ç‚º 30 çš„ sequence å—ï¼Ÿ</p>
<!-- raw HTML omitted -->
<p>å¯¦é©—çµæœçœ‹èµ·ä¾†æ˜¯ä¸è¡ŒğŸ˜…ã€‚\<br>
è€Œä¸”é•·åº¦ 20 çš„ sequence ä¹Ÿå­¸ä¸èµ·ä¾†ï¼Œé€™æ¨£æ˜¯å¦ä»£è¡¨ NTM æ²’æœ‰ generalization çš„èƒ½åŠ›å‘¢ï¼Ÿ</p>
<p>è®“æˆ‘å€‘æŠŠ train åœ¨ é•·åº¦ç‚º 3 ~ 20 çš„ sequence ä¹‹ modelï¼Œæ‹¿ä¾† predict åœ¨é•·åº¦ <!-- raw HTML omitted -->$\geq 20$<!-- raw HTML omitted -->çš„ sequence ä¸Šã€‚</p>
<!-- raw HTML omitted -->
<p>çœ‹èµ·ä¾†å®ƒæ˜¯æœ‰å­¸åˆ° generalization çš„ï¼Œ\<br>
è€Œä¸”å°æ–¼ memory å·²ç¶“ä¸å¤ æ”¾çš„éƒ¨ä»½ï¼Œä¹Ÿä¸æ˜¯ä¸€å£æ°£çˆ›æ‰ï¼Œé‚„æ˜¯æœ‰ç›¡é‡è¨˜åˆ°ä¸€äº›å€¼ã€‚</p>
<p><strong>Remark:</strong> model generalization çš„èƒ½åŠ›èˆ‡å…¶çœ‹éçš„ training data æœ‰é—œï¼Œä½†ä¸æ˜¯ç°¡å–®çš„ç·šæ€§é—œä¿‚è€Œå·²ã€‚</p>
<h3 id="some-training-detail">Some Training Detail</h3>
<ul>
<li>Memory çš„ä½¿ç”¨åŠ R/W weight è®ŠåŒ–</li>
</ul>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<ul>
<li>é€™è£¡å¯¦åšçš„ NTM ï¼Œcontoller åœ¨è¼¸å‡º final output æ™‚ï¼ŒåŒæ™‚è€ƒæ…®äº† read head ä»¥åŠ input çš„å€¼ã€‚\<br>
åœ¨ prediction éšæ®µï¼Œ current input éƒ½æ˜¯ dummy çš„ <!-- raw HTML omitted -->$\mathbf{0}$<!-- raw HTML omitted --> vectorï¼Œä½†å¦‚æœä¸è€ƒæ…®å®ƒçš„è©±ï¼ŒNTM å°±ç„¡æ³• train èµ·ä¾†ï¼Œæ¨æ¸¬å¯èƒ½æ˜¯åœ¨é‚£å€‹ dummy vector ï¼Œå° model è€Œè¨€å°±æ˜¯åƒ…æœ‰è®€è€Œæ²’æœ‰å¯«çš„æŒ‡ä»¤(å¦‚åŒä¸Šæ–¹æ‰€æåˆ°çš„ R/W mode åˆ‡æ›)ã€‚</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">forward</span>(self,x):
       <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;&#34;&#34;</span><span style="color:#e6db74">NTM forward</span><span style="color:#e6db74">&#34;&#34;&#34;</span>
       prev_reads,prev_ctrl_state,prev_heads_state <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>prev_state
       inp <span style="color:#f92672">=</span> torch<span style="color:#f92672">.</span>cat([x] <span style="color:#f92672">+</span> prev_reads,dim<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
       ctrl_outp,ctrl_state <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>controller(inp,prev_ctrl_state)
       reads <span style="color:#f92672">=</span> []
       heads_state <span style="color:#f92672">=</span> []
       <span style="color:#66d9ef">for</span> head,prev_head_state <span style="color:#f92672">in</span> zip(self<span style="color:#f92672">.</span>heads,prev_heads_state):
           <span style="color:#66d9ef">if</span> head<span style="color:#f92672">.</span>is_read_head():
               r,head_state <span style="color:#f92672">=</span> head(ctrl_outp,prev_head_state)
               reads <span style="color:#f92672">+</span><span style="color:#f92672">=</span> [r]
           <span style="color:#66d9ef">else</span>:
               head_state <span style="color:#f92672">=</span> head(ctrl_outp,prev_head_state)
           heads_state <span style="color:#f92672">+</span><span style="color:#f92672">=</span> [head_state]

       <span style="color:#75715e"># Retrieve output according to current reads</span>
       inp2 <span style="color:#f92672">=</span> torch<span style="color:#f92672">.</span>cat([x] <span style="color:#f92672">+</span> reads, dim<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
       o <span style="color:#f92672">=</span> F<span style="color:#f92672">.</span>sigmoid(self<span style="color:#f92672">.</span>fc(inp2)) <span style="color:#75715e"># range: [0,1]</span>
       self<span style="color:#f92672">.</span>prev_state <span style="color:#f92672">=</span> (reads,ctrl_state,heads_state)

       <span style="color:#66d9ef">return</span> o, self<span style="color:#f92672">.</span>prev_state
</code></pre></div><h2 id="reference">Reference</h2>
<ul>
<li><a href="https://distill.pub/2016/augmented-rnns/">Distill ä¸Šçš„æ–‡ç« </a></li>
<li><a href="https://arxiv.org/abs/1410.5401">åŸå§‹è«–æ–‡</a></li>
</ul>
  
  
<ul class="share-buttons">
	<li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fsunprinces.github.io%2flearning%2f2018%2f05%2fbeyond-rnn-lec1%2f" target="_blank" title="Share on Facebook"><i class="fa-facebook" aria-hidden="true"></i><span class="sr-only">Share on Facebook</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2fsunprinces.github.io%2flearning%2f2018%2f05%2fbeyond-rnn-lec1%2f&via=HorribleGeek" target="_blank" title="Tweet"><i class="fa-twitter" aria-hidden="true"></i><span class="sr-only">Tweet</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="https://plus.google.com/share?url=https%3a%2f%2fsunprinces.github.io%2flearning%2f2018%2f05%2fbeyond-rnn-lec1%2f" target="_blank" title="Share on Google+"><i class="fa-google-plus" aria-hidden="true"></i><span class="sr-only">Share on Google+</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2fsunprinces.github.io%2flearning%2f2018%2f05%2fbeyond-rnn-lec1%2f" target="_blank" title="Post to Tumblr"><i class="fa-tumblr" aria-hidden="true"></i><span class="sr-only">Post to Tumblr</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2fsunprinces.github.io%2flearning%2f2018%2f05%2fbeyond-rnn-lec1%2f" target="_blank" title="Pin it"><i class="fa-pinterest-p" aria-hidden="true"></i><span class="sr-only">Pin it</span></a>
	</li>&nbsp;&nbsp;&nbsp;
	<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2fsunprinces.github.io%2flearning%2f2018%2f05%2fbeyond-rnn-lec1%2f" target="_blank" title="Submit to Reddit"><i class="fa-reddit-alien" aria-hidden="true"></i><span class="sr-only">Submit to Reddit</span></a>
	</li>
</ul>


<style>
	ul.share-buttons{
	  list-style: none;
	  padding: 0;
	}

	ul.share-buttons li{
	  display: inline;
	}

	ul.share-buttons .sr-only{
	  position: absolute;
	  clip: rect(1px 1px 1px 1px);
	  clip: rect(1px, 1px, 1px, 1px);
	  padding: 0;
	  border: 0;
	  height: 1px;
	  width: 1px;
	  overflow: hidden;
	}
</style>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://sunprinces.github.io/learning/2018/04/speech-recognition-lec6/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://sunprinces.github.io/learning/2018/04/speech-recognition-lec6/">Speech Recognition- Lec6</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://sunprinces.github.io/learning/2018/10/ntu-machine-learning-lec13/">NTU Machine Learning - Lec13</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://sunprinces.github.io/learning/2018/10/ntu-machine-learning-lec13/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>



  
<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'tonyhsu822';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


  
<script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
 <script>renderMathInElement(document.body, {
   delimiters: [
     {left: "\\[", right: "\\]", display: true},
     {left: "$", right: "$", display: false},
   ]
 });</script>


<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [],
    displayMath: [['$$','$$']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});
</script>



</div>

</div>
</div>
<script src="https://sunprinces.github.io/learning/js/ui.js"></script>
<script src="https://sunprinces.github.io/learning/js/menus.js"></script>


<script>
  
  if (window.location.hostname != "localhost") {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-59748795-3', 'auto');
    ga('send', 'pageview');
  }
</script>






</body>
</html>

